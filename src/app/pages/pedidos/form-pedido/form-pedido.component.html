<div *ngIf='verForm'>
  <div class="container">
    <div class="row">
      <div class="col-sm-12">
        <app-card>
          <h4>Datos de pedido</h4>
          <form #encabezadoPedidoForm='ngForm' class='form-inline'>
            <div class='form-group'>
              <!-- SELECCICONA CLIENTE-->
              Cliente
              <input type='text' size="40" class='form-control' name='query'
              [(ngModel)]='queryBuscaCliente' placeholder='Seleccione Cliente...'>
              <!-- <div class="fixed-top" style='z-index:1000;'> -->
<!--                 <div id="toggle" onfocusout="" class='list-group' style='position:fixed; z-index:1000;' *ngIf='queryBuscaCliente'>
 -->
              <!-- <div class="collapse navbar-collapse" id="collapse"> -->
              <div id="toggle" onfocusout="" class='list-group'
              style='position:fixed; z-index:1000;' *ngIf='queryBuscaCliente'>
                <!-- LISTADO CLIENTES-->
                <button type="button" class="btn btn-primary"
                  *ngFor='let c of listaProductos | dataFilter: queryBuscaCliente : "desc"'
                  (click)='verCliente(c)'>{{c.desc}}
                </button>
                <!-- <a class='list-group-item  list-group-item-action' *ngFor='let c of listaProductos | dataFilter: queryBuscaCliente : "desc"'
                      (click)='verCliente(c)'>
                      {{c.desc}}
                    </a> -->
              </div>
              <!-- </div> -->
              <!--FECHA ENTREGA -->
              Fecha de Entrega
              <input class='form-control' name='fechaEntrega' [(ngModel)]='pedido.fechaEntrega' type="date" placeholder="Fecha entrega">
              <!--
                  (ngModelChange)='pedido.fechaEntrega=$event' ngbDatepicker
                    #d='ngbDatepicker' placeholder="Fecha entrega...">
                    <button (click)='d.toggle()' type='button'>
                      <img src=' ./assets/icon/calendar.svg' style='cursor: pointer;' />
                    </button> -->
            </div>
            <!-- Fecha entrega -->
            <!--       <div class='form-group mb-3'>
                </div>
           -->
          </form>
        </app-card>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12">
        <app-card>
          <h4>Seleccione Producto&nbsp;
              <button type="button"
              class="badge badge-danger">Nuevo Item
            </button>
          </h4>
            <!-- Formulario detalle Pedido -->
          <form #detallePedidoForm='ngForm' (ngSubmit)="onSubmitDetalle(detallePedido);"
          class='form-horizontal'>
            <table class="form-table-bordered">
              <thead class="thead-light">
                <tr>
                  <td>Categoria</td>
                  <td>Producto</td>
                  <td>Talla</td>
                  <td>Cantidad</td>
                  <td>Valor</td>
                  <!--           <td>Detalles</td>
        -->
                  <td><b>Total</b></td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="col-xs-1" style="width:140px;">
                    <select class='form-control' name='producto' [(ngModel)]='detallePedido.idProducto'
                    (change)='onSelectProducto($event.target.value)'>
                      <option [value]=''>[Producto]</option>
                      <option *ngFor='let producto of listaProductos' [value]='producto.idProducto'>{{producto.desc}}</option>
                    </select>
                  </td>
                  <td style="width:140px;">
                    <select class='form-control' name='tipoProducto'
                     [(ngModel)]='detallePedido.idTipoProducto'
                     (change)='onSelectTipoProducto($event.target.value)'
                     placeholder="[Tipo Producto]">
                      <option [value]=''>[Tipo Producto]</option>
                      <option *ngFor='let tipoProducto of listaTipoProducto' [value]='tipoProducto.id'>{{tipoProducto.desc}}</option>
                    </select>
                  </td>
                  <td style="width:90px;">
                    <select class='form-control' name='rangoPrecio'
                    [(ngModel)]='detallePedido.idRangoPrecio'
                    (change)='onSelectRangoPrecio($event.target.value)'>
                      <option [value]=''>[Talla]</option>
                      <option *ngFor='let rangoPrecio of listaRangoPrecios' [value]='rangoPrecio.id'>{{rangoPrecio.desc}}</option>
                    </select>
                  </td>
                  <td style="width:90px;">
                    <input type='number' class='form-control' name='cantidad'
                    [(ngModel)]='detallePedido.cantidad' placeholder='Cantidad' (input)='onChangeCalculaTotalDetalle($event.target.value)'>
                  </td>
                  <td style="width:100px;">
                    <input type='text' readonly class='form-control-plaintext form-control'
                     name='valor' [ngModel]='detallePedido.valor'
                      [ngModelOptions]='{standalone: true}'>
                  </td>
                  <td style="width:100px;">
                    <input type='text' readonly class='form-control-plaintext form-control' name='total'
                    [ngModel]='detallePedido.total' [ngModelOptions]='{standalone: true}'>
                  </td>
                  <td>
                    <button type="submit" class="btn btn-primary">
                        Añadir
                      <!-- <label *ngIf="!editando">Añadir</label>
                      <label *ngIf="editando">Modificar</label> -->
                    </button>
                    <button type="reset" class="btn btn-primary">Borrar</button>
                  </td>
                </tr>
              </tbody>
              <tfoot>
              </tfoot>
            </table>
            {{detallePedido | json}}
          </form>
        </app-card>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12">
        <app-card>
          <h4>Lista de productos&nbsp;
              <span *ngIf="cantidadProductos"
              class="badge badge-danger">{{cantidadProductos}}</span>
            </h4>
              <div class="container">
                <div class="row">
                  <table class="table table-bordered">
                    <thead>
                      <tr>
                      <th scope="col" style="width:45%">Descricpión</th>
                      <th scope="col">Subtotal</th>
                      <th scope="col">Diseño</th>
                      <th scope="col">Total Extras</th>
                      <th scope="col">Monto Total</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor='let c of pedido.listaProductos'>
                      <td class="fila">
                          <button type="button" (click)="verProducto(c)"
                            class="btn btn-outline-secondar text-left"
                            style="width:100%;">
                                {{c.descProducto}}<br>
                                  [{{c.descTipoProducto}}]
                                / Tallas: [{{c.descRangoPrecio}}]
                          </button>
                      </td>
<!--  GRUPO SUBTOTAL ITEM -->
                      <td class="fila" style="width:15%">
                        <h1 class="badge badge-secondary">${{c.valor}}</h1>
                        x {{c.cantidad}}<br>
                        <h3 >${{c.total}}</h3>
                      </td>
                      <td class="fila" style="width:25%">
                        <div class="input-group mb-3">
                          <div class="input-group-prepend">
<!--  GRUPO BOTONES DISEÑO -->
                            <div class="btn-group btn-group-toggle"
                              ngbRadioGroup name='llevaDiseno' [(ngModel)]='c.llevaDiseno'>

                              <label ngbButtonLabel class="btn btn-outline-primary btn-sm">
                                <input ngbButton type="radio" [value]="0"><b>No</b>
                              </label>
                              <label ngbButtonLabel class="btn btn-outline-primary btn-sm">
                                <input ngbButton type="radio" [value]="1"><b>Si</b>
                              </label>
                            </div>
                          </div>
<!--  SELECT DISEÑO -->
                          <select class='form-control' name='color' [(ngModel)]='c.idColor'
                            *ngIf='c.llevaDiseno==0'>
                            <option [value]=''>[Color]</option>
                            <option *ngFor='let color of listaColores' [value]='color.id'>{{color.desc}}</option>
                          </select>
                        </div>
<!--                         <div style="display: inline;" *ngIf='c.llevaDiseno==0'>
                          <select class='form-control' name='color' [(ngModel)]='c.idColor'>
                            <option [value]=''>[Color]</option>
                            <option *ngFor='let color of listaColores' [value]='color.id'>{{color.desc}}</option>
                          </select>
                        </div>
 --><!--                           <div *ngIf='c.llevaDiseno==1'>
                            <a href="#" class="btn-primary">Añadir Tallas</a>
                          </div>
 -->
                     </td>
                     <td class="fila" style="width:15%">

                     </td>
                     <td class="fila" style="width:15%">

                     </td>
                    </tr>
                  </tbody>
                </table>
              </div>
        <!--
                <div class="col-sm-5" (click)="isCollapsed = !isCollapsed"
                [attr.aria-expanded]="!isCollapsed" aria-controls="collapseExample">
                    <p *ngFor='let d of listaProductos | dataFilter: c.idProducto : "idProducto"'>
                        {{d.desc}}
                      </p>
                      <p *ngFor='let d of listaTipoProducto | dataFilter: c.idTipoProducto : "id"'>
                          [{{d.desc}}]
                      </p>
                      <span class="badge badge-secondary">${{c.total}}</span>

                </div>
                <div class="col-sm-5">
                  <div class="btn-group btn-group-toggle"
                    ngbRadioGroup name='llevaDiseno' [(ngModel)]='c.llevaDiseno'>

                    <label ngbButtonLabel class="btn-primary">
                      <input ngbButton type="radio" [value]="0">Color
                    </label>
                    <label ngbButtonLabel class="btn-primary">
                      <input ngbButton type="radio" [value]="1">Diseño
                    </label>
                    <div *ngIf='c.llevaDiseno==0'>
                      <select class='form-control' name='color' [(ngModel)]='c.idColor'>
                        <option [value]=''>[Color]</option>
                        <option *ngFor='let color of listaColores' [value]='color.id'>{{color.desc}}</option>
                      </select>
                    </div>
                    <div *ngIf='c.llevaDiseno==1'>
                      <a href="#" class="btn-primary">Añadir Tallas</a>
                    </div>
                  </div>
                </div>
                <div id="collapseExample" [ngbCollapse]="!isCollapsed">
                    <div class="card">
                        <a href="#" (click)="isCollapsed = !isCollapsed">Cerrar</a>
                        <div class="card-body">
                        <div class="col-sm-5" id="collapseDetalle">
                          <select class='form-control' name='listaDetalles'
                          [(ngModel)]='detallePedido.listaAdicionales' (change)='addDetalleAdicional(c, $event.target.value)'>
                              <option [value]=''>[Talla]</option>
                              <option *ngFor='let detalleAdicional of listaDetallesAdicionales' [value]='detalleAdicional.id'>{{detalleAdicional.desc}}</option>
                            </select>
                      </div>
                      </div>
                    </div>
                  </div>

            </li>
            </ul>
-->
          </div>
        </app-card>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-7">
        <app-card>
          <h4>Comentarios</h4>
          <div class="container">
            <textarea class="form-control rounded-0"
              name="pedido.comentarios" rows="4"></textarea>
          </div>
        </app-card>
        <app-card>
          <h4>Forma de pago</h4>
          <div class="container">
          </div>
        </app-card>
      </div>
      <div class="col-sm-5">
        <app-card>
          <h4>Total Pedido</h4>
          <div class="container">
            <ul class="list-group">
              <li class="list-group-item">
                <div class="row">
                  <div class="col-sm-5">
                    <h5>Subtotal</h5>
                  </div>
                  <div class="col-sm-6">
                    <h4>${{pedido.subTotal}}</h4>
                  </div>
                </div>
              </li>
              <li class="list-group-item">
                <div class="row">
                  <div class="col-sm-5">
                    <h5>Descuento %</h5>
                  </div>
                  <div class="col-sm-6">
                    <h4>
                      <input type='number' class='form-control' name='descuento' [(ngModel)]='pedido.descuento' placeholder='Descuento' (input)='onChangeCalculaTotal()'>
                    </h4>
                  </div>
                </div>
              </li>
              <li class="list-group-item">
                <div class="row">
                  <div class="col-sm-6">
                    <h5>Valor Neto</h5>
                  </div>
                  <div class="col-sm-6">
                    <h4>${{pedido.subTotalNeto}}</h4>
                  </div>
                </div>
              </li>
              <li class="list-group-item">
                <div class="row">
                  <div class="col-sm-6">
                    <h5>Iva 19%</h5>
                  </div>
                  <div class="col-sm-6">
                    <h4>${{pedido.iva}}</h4>
                  </div>
                </div>
              </li>
              <li class="list-group-item">
                <div class="row">
                  <div class="col-sm-6">
                    <h5>Monto Total</h5>
                  </div>
                  <div class="col-sm-6">
                    <h4>${{pedido.total}}</h4>
                  </div>
                </div>
              </li>
            </ul>
          </div>
        </app-card>
      </div>
    </div>
  </div>
  <div class='form-group'>
    <button type='reset' class='btn btn-default'>Cancelar</button>
    <button type='submit' class='btn btn-primary'>Crear</button>

  </div>
  {{ pedido | json }}
</div>
